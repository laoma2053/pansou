# 版本管理指南

## 📝 为什么需要版本管理？

由于使用了CDN和浏览器缓存，每次修改CSS或JS文件后，如果不更新版本号，用户可能看到的还是旧版本的缓存文件。

## 🔧 版本号管理方式

### 当前使用的格式：`YYYYMMDD + 字母`

例如：`20250802c`
- `20250802` = 2025年8月2日
- `c` = 当天的第3个版本（a=第1个，b=第2个，c=第3个...）

## 📋 每次修改代码的步骤

### 1. 确定版本号
- 如果是同一天的修改：只需要更新字母（a→b→c→d...）
- 如果是新的一天：更新日期，字母重新从`a`开始

### 2. 统一修改版本号
在 `index.html` 文件中，只需要修改这些地方的版本号：

```html
<!-- 第12行附近 -->
window.CACHE_VERSION = '20250802c';  // ← 修改这里

<!-- 第150行附近 -->
<link rel="stylesheet" href="style.css?v=20250802c" media="print" onload="this.media='all'">
<link rel="stylesheet" href="modules/ads.css?v=20250802c" media="print" onload="this.media='all'">

<!-- 第280行附近 -->
<script defer src="modules/config.js?v=20250802c"></script>
<script defer src="modules/analytics.js?v=20250802c"></script>
<script defer src="modules/ads.js?v=20250802c"></script>
<script defer src="modules/module-manager.js?v=20250802c"></script>
<script defer src="modules/quick-setup.js?v=20250802c"></script>
<script defer src="script.js?v=20250802c"></script>
```

### 3. 查找替换技巧
使用编辑器的"查找替换"功能：
- 查找：`?v=20250802c`
- 替换为：`?v=20250802d`（或新的版本号）

## 🚀 部署后的操作

1. **重新部署容器**
2. **清除CDN缓存**（在1Panel面板中）
3. **测试验证**：
   - 先访问IP+端口确认更新生效
   - 再访问域名确认CDN也更新了

## 💡 版本号命名建议

- **小修改**（样式调整、文本修改）：`a → b → c`
- **功能更新**：换新日期，从 `a` 开始
- **重大更新**：可以在日期后加特殊标识，如 `20250802-major`

## ⚠️ 重要提醒

- 每次修改 CSS 或 JS 文件后，**必须**更新版本号
- 版本号要保持一致，不要有遗漏
- 部署后记得清除CDN缓存

## 🔮 未来优化建议

如果后续修改频繁，可以考虑：
1. 使用构建工具自动生成版本号
2. 使用Git commit hash作为版本号
3. 设置自动化的部署脚本
